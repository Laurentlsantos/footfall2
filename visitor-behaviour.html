<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Visitor Behaviour | Understanding Visitors with Social and Geographic Datasets: a tutorial book for local authorities, real estate and retail</title>
  <meta name="description" content="3 Visitor Behaviour | Understanding Visitors with Social and Geographic Datasets: a tutorial book for local authorities, real estate and retail" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Visitor Behaviour | Understanding Visitors with Social and Geographic Datasets: a tutorial book for local authorities, real estate and retail" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Visitor Behaviour | Understanding Visitors with Social and Geographic Datasets: a tutorial book for local authorities, real estate and retail" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visit-frequency.html"/>
<link rel="next" href="visitor-profile.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#online-version"><i class="fa fa-check"></i>Online Version</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the Author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#location-technologies"><i class="fa fa-check"></i><b>1.1</b> Location Technologies</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#vi-data-infrastructure"><i class="fa fa-check"></i><b>1.2</b> VI Data Infrastructure</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#privacy-compliant-data-collection-and-use"><i class="fa fa-check"></i><b>1.3</b> Privacy-compliant data collection and use</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#representing-and-working-with-data"><i class="fa fa-check"></i><b>1.4</b> Representing and Working with Data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visit-frequency.html"><a href="visit-frequency.html"><i class="fa fa-check"></i><b>2</b> Visit Frequency</a><ul>
<li class="chapter" data-level="2.1" data-path="visit-frequency.html"><a href="visit-frequency.html#monthly-visits"><i class="fa fa-check"></i><b>2.1</b> Monthly Visits</a></li>
<li class="chapter" data-level="2.2" data-path="visit-frequency.html"><a href="visit-frequency.html#visits-by-day"><i class="fa fa-check"></i><b>2.2</b> Visits by Day</a></li>
<li class="chapter" data-level="2.3" data-path="visit-frequency.html"><a href="visit-frequency.html#visits-by-time-intervals"><i class="fa fa-check"></i><b>2.3</b> Visits by Time Intervals</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visitor-behaviour.html"><a href="visitor-behaviour.html"><i class="fa fa-check"></i><b>3</b> Visitor Behaviour</a><ul>
<li class="chapter" data-level="3.1" data-path="visitor-behaviour.html"><a href="visitor-behaviour.html#visit-dwell-time"><i class="fa fa-check"></i><b>3.1</b> Visit Dwell Time</a></li>
<li class="chapter" data-level="3.2" data-path="visitor-behaviour.html"><a href="visitor-behaviour.html#visit-frequency-1"><i class="fa fa-check"></i><b>3.2</b> Visit Frequency</a></li>
<li class="chapter" data-level="3.3" data-path="visitor-behaviour.html"><a href="visitor-behaviour.html#number-of-indoor-locations-visited-per-trip"><i class="fa fa-check"></i><b>3.3</b> Number of indoor locations visited per trip</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visitor-profile.html"><a href="visitor-profile.html"><i class="fa fa-check"></i><b>4</b> Visitor Profile</a><ul>
<li class="chapter" data-level="4.1" data-path="visitor-profile.html"><a href="visitor-profile.html#age-distribution"><i class="fa fa-check"></i><b>4.1</b> Age Distribution</a></li>
<li class="chapter" data-level="4.2" data-path="visitor-profile.html"><a href="visitor-profile.html#visitor-s-origin"><i class="fa fa-check"></i><b>4.2</b> Visitor’ s Origin</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html"><i class="fa fa-check"></i><b>5</b> Geospatial Analysis</a></li>
<li class="chapter" data-level="6" data-path="competition.html"><a href="competition.html"><i class="fa fa-check"></i><b>6</b> Competition</a></li>
<li class="chapter" data-level="7" data-path="location-portfolio-analysis.html"><a href="location-portfolio-analysis.html"><i class="fa fa-check"></i><b>7</b> Location Portfolio Analysis</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Understanding Visitors with Social and Geographic Datasets: a tutorial book for local authorities, real estate and retail</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visitor-behaviour" class="section level1">
<h1><span class="header-section-number">3</span> Visitor Behaviour</h1>
<hr />
<p>In this section we will tackle the metrics associated with the manner visitors behave in their journeys.</p>
<p>We will investigate three principal metrics: the dwell time visitors spend in a cluster location, the overall number of visits made by each visitor on your site and the number of indoor locations visited per trip.</p>
<p>Similar to the last chapter, we need first to load the libraries to be used in the section and then the training files into R.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="visitor-behaviour.html#cb1-1"></a><span class="co"># install if necessary using &#39;install.packages&#39;</span></span>
<span id="cb1-2"><a href="visitor-behaviour.html#cb1-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="visitor-behaviour.html#cb1-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="visitor-behaviour.html#cb1-4"></a><span class="kw">library</span>(plotly)</span>
<span id="cb1-5"><a href="visitor-behaviour.html#cb1-5"></a><span class="kw">library</span>(dplyr)</span></code></pre></div>
<div id="visit-dwell-time" class="section level2">
<h2><span class="header-section-number">3.1</span> Visit Dwell Time</h2>
<p><strong>Dwell time</strong> measures the length of time a person spends or remains remains in a specific area.</p>
<p>For retail, It is an essential metric for analysing shopping experience and increasing customer spending. In general, there is a significant and positive relationship between dwell time and sales.</p>
<p>The metric can also provides good insights for urban planners. Analysing dwell time in historic basis provides ways to better understand the impacts of renovated spaces and help redesigning street network and accessibility.</p>
<p>Let’s begin the exercise uploading the file into R and setting the fields in the corret format</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="visitor-behaviour.html#cb2-1"></a><span class="co"># load the data provided with the command read()</span></span>
<span id="cb2-2"><a href="visitor-behaviour.html#cb2-2"></a>data_dwell &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;C:/data/visit_dwell_time.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">fileEncoding=</span><span class="st">&quot;UTF-8-BOM&quot;</span>)</span>
<span id="cb2-3"><a href="visitor-behaviour.html#cb2-3"></a></span>
<span id="cb2-4"><a href="visitor-behaviour.html#cb2-4"></a><span class="co"># define the correct format</span></span>
<span id="cb2-5"><a href="visitor-behaviour.html#cb2-5"></a>data_dwell &lt;-<span class="st"> </span>data_dwell <span class="op">%&gt;%</span></span>
<span id="cb2-6"><a href="visitor-behaviour.html#cb2-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">month =</span> <span class="kw">as.Date</span>(month)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-7"><a href="visitor-behaviour.html#cb2-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">as.character</span>(year))</span>
<span id="cb2-8"><a href="visitor-behaviour.html#cb2-8"></a></span>
<span id="cb2-9"><a href="visitor-behaviour.html#cb2-9"></a><span class="co"># re-order the months</span></span>
<span id="cb2-10"><a href="visitor-behaviour.html#cb2-10"></a>data_dwell &lt;-<span class="st"> </span>data_dwell <span class="op">%&gt;%</span></span>
<span id="cb2-11"><a href="visitor-behaviour.html#cb2-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mm =</span> <span class="kw">fct_relevel</span>(mm, </span>
<span id="cb2-12"><a href="visitor-behaviour.html#cb2-12"></a>                          <span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>,<span class="st">&quot;Apr&quot;</span>, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;Jun&quot;</span>, </span>
<span id="cb2-13"><a href="visitor-behaviour.html#cb2-13"></a>                          <span class="st">&quot;Jul&quot;</span>, <span class="st">&quot;Aug&quot;</span>, <span class="st">&quot;Sep&quot;</span>, <span class="st">&quot;Oct&quot;</span>, <span class="st">&quot;Nov&quot;</span>, <span class="st">&quot;Dec&quot;</span>)) </span></code></pre></div>
<p>The first visualisation deals with historical data. As in the previous chapter, we can use <code>plotly()</code> for an interactive visualisation.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="visitor-behaviour.html#cb3-1"></a>g9 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> data_dwell, <span class="kw">aes</span>(month, dwell)) <span class="op">+</span></span>
<span id="cb3-2"><a href="visitor-behaviour.html#cb3-2"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>comma)<span class="op">+</span></span>
<span id="cb3-3"><a href="visitor-behaviour.html#cb3-3"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb3-4"><a href="visitor-behaviour.html#cb3-4"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb3-5"><a href="visitor-behaviour.html#cb3-5"></a><span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_date</span>(<span class="st">&quot;%B</span><span class="ch">\n</span><span class="st">%Y&quot;</span>))<span class="op">+</span></span>
<span id="cb3-6"><a href="visitor-behaviour.html#cb3-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;dwell time (mins)&quot;</span>, </span>
<span id="cb3-7"><a href="visitor-behaviour.html#cb3-7"></a>       <span class="dt">x=</span><span class="st">&quot;date&quot;</span>, </span>
<span id="cb3-8"><a href="visitor-behaviour.html#cb3-8"></a>       <span class="dt">title =</span> <span class="kw">paste</span>(<span class="st">&quot;Average dwell time&quot;</span>))</span>
<span id="cb3-9"><a href="visitor-behaviour.html#cb3-9"></a></span>
<span id="cb3-10"><a href="visitor-behaviour.html#cb3-10"></a><span class="kw">ggplotly</span>(g9) </span></code></pre></div>
<div id="htmlwidget-94ac9230e399d7323e1d" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-94ac9230e399d7323e1d">{"x":{"data":[{"x":[17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078,18109,18140,18170,18201,18231,18262,18293,18322,18353,18383,18414,18444,18475,18506,18536,18567,18597,18628,18659,18687,18718,18748,18779],"y":[93.63053333,92.35833333,88.0528,96.7542,91.8625,88.625,88.69585,89.0833,88,91.8667,101.4,114.8333,96.5833,97.6167,95.7917,98.7167,94.625,94.05,89.2417,91.825,94.1583,99.5333,106.05,106.3833,88.325,82.6833,89.3667,94.7917,89.1,83.2,88.15,83.1083,82.7,82.8417,92.9167,109.8,95.9833,96.775,79,49.6833,50.2833,67.8333,80.0917,88.6333,80.95,89.725,59.4083,96.175,41.4083,43.1167,45.7833,80.25,85.35,87.25],"text":["month: 2017-01-01<br />dwell:  93.63053","month: 2017-02-01<br />dwell:  92.35833","month: 2017-03-01<br />dwell:  88.05280","month: 2017-04-01<br />dwell:  96.75420","month: 2017-05-01<br />dwell:  91.86250","month: 2017-06-01<br />dwell:  88.62500","month: 2017-07-01<br />dwell:  88.69585","month: 2017-08-01<br />dwell:  89.08330","month: 2017-09-01<br />dwell:  88.00000","month: 2017-10-01<br />dwell:  91.86670","month: 2017-11-01<br />dwell: 101.40000","month: 2017-12-01<br />dwell: 114.83330","month: 2018-01-01<br />dwell:  96.58330","month: 2018-02-01<br />dwell:  97.61670","month: 2018-03-01<br />dwell:  95.79170","month: 2018-04-01<br />dwell:  98.71670","month: 2018-05-01<br />dwell:  94.62500","month: 2018-06-01<br />dwell:  94.05000","month: 2018-07-01<br />dwell:  89.24170","month: 2018-08-01<br />dwell:  91.82500","month: 2018-09-01<br />dwell:  94.15830","month: 2018-10-01<br />dwell:  99.53330","month: 2018-11-01<br />dwell: 106.05000","month: 2018-12-01<br />dwell: 106.38330","month: 2019-01-01<br />dwell:  88.32500","month: 2019-02-01<br />dwell:  82.68330","month: 2019-03-01<br />dwell:  89.36670","month: 2019-04-01<br />dwell:  94.79170","month: 2019-05-01<br />dwell:  89.10000","month: 2019-06-01<br />dwell:  83.20000","month: 2019-07-01<br />dwell:  88.15000","month: 2019-08-01<br />dwell:  83.10830","month: 2019-09-01<br />dwell:  82.70000","month: 2019-10-01<br />dwell:  82.84170","month: 2019-11-01<br />dwell:  92.91670","month: 2019-12-01<br />dwell: 109.80000","month: 2020-01-01<br />dwell:  95.98330","month: 2020-02-01<br />dwell:  96.77500","month: 2020-03-01<br />dwell:  79.00000","month: 2020-04-01<br />dwell:  49.68330","month: 2020-05-01<br />dwell:  50.28330","month: 2020-06-01<br />dwell:  67.83330","month: 2020-07-01<br />dwell:  80.09170","month: 2020-08-01<br />dwell:  88.63330","month: 2020-09-01<br />dwell:  80.95000","month: 2020-10-01<br />dwell:  89.72500","month: 2020-11-01<br />dwell:  59.40830","month: 2020-12-01<br />dwell:  96.17500","month: 2021-01-01<br />dwell:  41.40830","month: 2021-02-01<br />dwell:  43.11670","month: 2021-03-01<br />dwell:  45.78330","month: 2021-04-01<br />dwell:  80.25000","month: 2021-05-01<br />dwell:  85.35000","month: 2021-06-01<br />dwell:  87.25000"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Average dwell time","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[17086.4,18859.6],"tickmode":"array","ticktext":["January<br />2017","January<br />2018","January<br />2019","January<br />2020","January<br />2021"],"tickvals":[17167,17532,17897,18262,18628],"categoryorder":"array","categoryarray":["January<br />2017","January<br />2018","January<br />2019","January<br />2020","January<br />2021"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"date","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[37.73705,118.50455],"tickmode":"array","ticktext":["40","60","80","100"],"tickvals":[40,60,80,100],"categoryorder":"array","categoryarray":["40","60","80","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"dwell time (mins)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"285c465b3ca2":{"x":{},"y":{},"type":"scatter"},"285c7e0a7b81":{"x":{},"y":{}}},"cur_data":"285c465b3ca2","visdat":{"285c465b3ca2":["function (y) ","x"],"285c7e0a7b81":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>We can also plot a graph with <code>ggplot2()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="visitor-behaviour.html#cb4-1"></a>g10 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data_dwell, <span class="kw">aes</span>(month, dwell)) <span class="op">+</span></span>
<span id="cb4-2"><a href="visitor-behaviour.html#cb4-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">&quot;darkturquoise&quot;</span> ,</span>
<span id="cb4-3"><a href="visitor-behaviour.html#cb4-3"></a>             <span class="dt">size =</span> <span class="dv">3</span>, </span>
<span id="cb4-4"><a href="visitor-behaviour.html#cb4-4"></a>             <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)<span class="op">+</span></span>
<span id="cb4-5"><a href="visitor-behaviour.html#cb4-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">na.rm =</span> <span class="ot">TRUE</span>,</span>
<span id="cb4-6"><a href="visitor-behaviour.html#cb4-6"></a>            <span class="dt">colour =</span> <span class="st">&quot;darkturquoise&quot;</span>, <span class="dt">size =</span> <span class="fl">1.3</span>) <span class="op">+</span></span>
<span id="cb4-7"><a href="visitor-behaviour.html#cb4-7"></a><span class="st">  </span><span class="kw">annotate</span>(</span>
<span id="cb4-8"><a href="visitor-behaviour.html#cb4-8"></a>    <span class="dt">geom =</span> <span class="st">&quot;segment&quot;</span>, <span class="dt">x =</span> <span class="kw">ymd</span>(<span class="st">&quot;2020-03-23&quot;</span>), <span class="dt">y =</span> <span class="dv">105</span>, <span class="dt">xend =</span> <span class="kw">ymd</span>(<span class="st">&quot;2020-03-23&quot;</span>), <span class="dt">yend =</span> <span class="dv">95</span>, </span>
<span id="cb4-9"><a href="visitor-behaviour.html#cb4-9"></a>    <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>))</span>
<span id="cb4-10"><a href="visitor-behaviour.html#cb4-10"></a>  ) <span class="op">+</span></span>
<span id="cb4-11"><a href="visitor-behaviour.html#cb4-11"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">ymd</span>(<span class="st">&quot;2020-03-12&quot;</span>), <span class="dt">y =</span> <span class="dv">110</span>,  <span class="dt">label =</span> <span class="st">&quot;lockdown</span><span class="ch">\n</span><span class="st">23 March 2020&quot;</span>, <span class="dt">hjust =</span> <span class="st">&quot;left&quot;</span>) <span class="op">+</span></span>
<span id="cb4-12"><a href="visitor-behaviour.html#cb4-12"></a><span class="st">  </span><span class="kw">theme_light</span>()</span>
<span id="cb4-13"><a href="visitor-behaviour.html#cb4-13"></a></span>
<span id="cb4-14"><a href="visitor-behaviour.html#cb4-14"></a></span>
<span id="cb4-15"><a href="visitor-behaviour.html#cb4-15"></a>g10 <span class="op">+</span></span>
<span id="cb4-16"><a href="visitor-behaviour.html#cb4-16"></a><span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_date</span>(<span class="st">&quot;%B</span><span class="ch">\n</span><span class="st">%Y&quot;</span>))<span class="op">+</span></span>
<span id="cb4-17"><a href="visitor-behaviour.html#cb4-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;dwell time (mins)&quot;</span>, </span>
<span id="cb4-18"><a href="visitor-behaviour.html#cb4-18"></a>       <span class="dt">x=</span><span class="st">&quot;date&quot;</span>, </span>
<span id="cb4-19"><a href="visitor-behaviour.html#cb4-19"></a>       <span class="dt">title =</span> <span class="kw">paste</span>(<span class="st">&quot;Average dwell time&quot;</span>),</span>
<span id="cb4-20"><a href="visitor-behaviour.html#cb4-20"></a>       <span class="dt">caption =</span> <span class="st">&quot;Source: Visitor Insights&quot;</span>)</span></code></pre></div>
<p><img src="images/unnamed-chunk-5-1.png" width="672" /></p>
<p>It could be a good idea to explore seasonality using <em>faceting</em>.</p>
<p>With <code>facet_wrap()</code> we can make a ribbon of panels with dwell time by year. Note that we can also make available the dwell time value of each point (or month).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="visitor-behaviour.html#cb5-1"></a>g11 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data_dwell, <span class="kw">aes</span>(mm, dwell, <span class="dt">color =</span> year)) <span class="op">+</span></span>
<span id="cb5-2"><a href="visitor-behaviour.html#cb5-2"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>comma)<span class="op">+</span></span>
<span id="cb5-3"><a href="visitor-behaviour.html#cb5-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> year), <span class="dt">size =</span> <span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb5-4"><a href="visitor-behaviour.html#cb5-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">group =</span> year), <span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span><span class="st"> </span></span>
<span id="cb5-5"><a href="visitor-behaviour.html#cb5-5"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&#39;Program Type&#39;</span>)<span class="op">+</span></span>
<span id="cb5-6"><a href="visitor-behaviour.html#cb5-6"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>year,<span class="dt">nrow =</span> <span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb5-7"><a href="visitor-behaviour.html#cb5-7"></a><span class="st">  </span><span class="kw">theme_light</span>()<span class="op">+</span></span>
<span id="cb5-8"><a href="visitor-behaviour.html#cb5-8"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">round</span>(dwell, <span class="dv">0</span>)),</span>
<span id="cb5-9"><a href="visitor-behaviour.html#cb5-9"></a>            <span class="dt">colour =</span> <span class="st">&quot;grey32&quot;</span>,</span>
<span id="cb5-10"><a href="visitor-behaviour.html#cb5-10"></a>            <span class="dt">size =</span> <span class="dv">3</span>,</span>
<span id="cb5-11"><a href="visitor-behaviour.html#cb5-11"></a>            <span class="dt">vjust =</span> <span class="st">&quot;inward&quot;</span>, <span class="dt">hjust =</span> <span class="st">&quot;outward&quot;</span>,</span>
<span id="cb5-12"><a href="visitor-behaviour.html#cb5-12"></a>            <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span>
<span id="cb5-13"><a href="visitor-behaviour.html#cb5-13"></a></span>
<span id="cb5-14"><a href="visitor-behaviour.html#cb5-14"></a></span>
<span id="cb5-15"><a href="visitor-behaviour.html#cb5-15"></a>g11 <span class="op">+</span></span>
<span id="cb5-16"><a href="visitor-behaviour.html#cb5-16"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">2.6</span>, <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb5-17"><a href="visitor-behaviour.html#cb5-17"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey50&quot;</span>)) <span class="op">+</span></span>
<span id="cb5-18"><a href="visitor-behaviour.html#cb5-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">-90</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></span>
<span id="cb5-19"><a href="visitor-behaviour.html#cb5-19"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;dwell time (mins)&quot;</span>, </span>
<span id="cb5-20"><a href="visitor-behaviour.html#cb5-20"></a>       <span class="dt">x=</span><span class="st">&quot;date&quot;</span>, </span>
<span id="cb5-21"><a href="visitor-behaviour.html#cb5-21"></a>       <span class="dt">title =</span> <span class="kw">paste</span>(<span class="st">&quot;Average dwell time&quot;</span>),</span>
<span id="cb5-22"><a href="visitor-behaviour.html#cb5-22"></a>       <span class="dt">caption =</span> <span class="st">&quot;Source: Visitor Insights&quot;</span>)</span></code></pre></div>
<p><img src="images/unnamed-chunk-6-1.png" width="672" /></p>
<p>Finally, we should calculate the average dwell time by year to understand any change in visitor dwell time.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="visitor-behaviour.html#cb6-1"></a>data_dwell_avg &lt;-<span class="st"> </span>data_dwell <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-2"><a href="visitor-behaviour.html#cb6-2"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb6-3"><a href="visitor-behaviour.html#cb6-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">dwell =</span> <span class="kw">mean</span>(dwell)) </span>
<span id="cb6-4"><a href="visitor-behaviour.html#cb6-4"></a></span>
<span id="cb6-5"><a href="visitor-behaviour.html#cb6-5"></a></span>
<span id="cb6-6"><a href="visitor-behaviour.html#cb6-6"></a>g12 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data_dwell_avg, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> dwell)) <span class="op">+</span></span>
<span id="cb6-7"><a href="visitor-behaviour.html#cb6-7"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;cyan4&quot;</span>)<span class="op">+</span></span>
<span id="cb6-8"><a href="visitor-behaviour.html#cb6-8"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>comma) <span class="op">+</span></span>
<span id="cb6-9"><a href="visitor-behaviour.html#cb6-9"></a><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></span>
<span id="cb6-10"><a href="visitor-behaviour.html#cb6-10"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">round</span>(dwell, <span class="dv">0</span>)),</span>
<span id="cb6-11"><a href="visitor-behaviour.html#cb6-11"></a>            <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb6-12"><a href="visitor-behaviour.html#cb6-12"></a>            <span class="dt">size =</span> <span class="dv">8</span>,</span>
<span id="cb6-13"><a href="visitor-behaviour.html#cb6-13"></a>            <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb6-14"><a href="visitor-behaviour.html#cb6-14"></a>            <span class="dt">vjust =</span> <span class="fl">1.5</span>) </span>
<span id="cb6-15"><a href="visitor-behaviour.html#cb6-15"></a>g12 <span class="op">+</span></span>
<span id="cb6-16"><a href="visitor-behaviour.html#cb6-16"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey50&quot;</span>)) <span class="op">+</span></span>
<span id="cb6-17"><a href="visitor-behaviour.html#cb6-17"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>)) <span class="op">+</span></span>
<span id="cb6-18"><a href="visitor-behaviour.html#cb6-18"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;average dwell time (mins)&quot;</span>, </span>
<span id="cb6-19"><a href="visitor-behaviour.html#cb6-19"></a>       <span class="dt">x=</span><span class="st">&quot;year&quot;</span>,</span>
<span id="cb6-20"><a href="visitor-behaviour.html#cb6-20"></a>       <span class="dt">caption =</span> <span class="st">&quot;Note: 2021 as for July</span><span class="ch">\n</span><span class="st">Source: Visitor Insights&quot;</span>)</span></code></pre></div>
<p><img src="images/unnamed-chunk-7-1.png" width="672" /></p>
<p>It can be highlighted from the graph the the average dwell time has been consistently declining since 2018. It is advisable to cross check data to better understand this trend.</p>
</div>
<div id="visit-frequency-1" class="section level2">
<h2><span class="header-section-number">3.2</span> Visit Frequency</h2>
<p><strong>Visit frequency</strong> tells you how many people visit your location repeatedly within a specific time period. VI dataset breaks down the frequency in five periods: annually, half yearly, quarterly, monthly and weekly.</p>
<p>In retail, visit frequency reveals consumer’s behaviour and preferences and is usually related to the level of customer’s loyalty. The metric can provides good clues to understand the relationships between frequency and characteristics of shoppers such as functional shopping motivation, recreational shopping motivation, age, income and family size.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="visitor-behaviour.html#cb7-1"></a>data_frequency &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;C:/data/visit_frequency.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">fileEncoding=</span><span class="st">&quot;UTF-8-BOM&quot;</span>)</span>
<span id="cb7-2"><a href="visitor-behaviour.html#cb7-2"></a></span>
<span id="cb7-3"><a href="visitor-behaviour.html#cb7-3"></a></span>
<span id="cb7-4"><a href="visitor-behaviour.html#cb7-4"></a></span>
<span id="cb7-5"><a href="visitor-behaviour.html#cb7-5"></a><span class="co"># then ordering the frequencies</span></span>
<span id="cb7-6"><a href="visitor-behaviour.html#cb7-6"></a>data_frequency &lt;-<span class="st"> </span>data_frequency <span class="op">%&gt;%</span></span>
<span id="cb7-7"><a href="visitor-behaviour.html#cb7-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">frequency =</span> <span class="kw">fct_relevel</span>(frequency, </span>
<span id="cb7-8"><a href="visitor-behaviour.html#cb7-8"></a>                                 <span class="st">&quot;annually&quot;</span>, <span class="st">&quot;half yearly&quot;</span>, <span class="st">&quot;quarterly&quot;</span>, </span>
<span id="cb7-9"><a href="visitor-behaviour.html#cb7-9"></a>                                 <span class="st">&quot;monthly&quot;</span>, <span class="st">&quot;weekly&quot;</span>))  </span>
<span id="cb7-10"><a href="visitor-behaviour.html#cb7-10"></a></span>
<span id="cb7-11"><a href="visitor-behaviour.html#cb7-11"></a></span>
<span id="cb7-12"><a href="visitor-behaviour.html#cb7-12"></a>g6 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data_frequency, <span class="kw">aes</span>(<span class="dt">fill=</span> frequency, <span class="dt">y=</span> pct,  <span class="dt">x=</span> year)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-13"><a href="visitor-behaviour.html#cb7-13"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;darkcyan&quot;</span>) <span class="op">+</span></span>
<span id="cb7-14"><a href="visitor-behaviour.html#cb7-14"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> scales<span class="op">::</span><span class="kw">percent</span>((pct),.<span class="dv">2</span>),</span>
<span id="cb7-15"><a href="visitor-behaviour.html#cb7-15"></a>                <span class="dt">y =</span> pct, </span>
<span id="cb7-16"><a href="visitor-behaviour.html#cb7-16"></a>                <span class="dt">group =</span> year,),</span>
<span id="cb7-17"><a href="visitor-behaviour.html#cb7-17"></a>            <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb7-18"><a href="visitor-behaviour.html#cb7-18"></a>            <span class="dt">vjust =</span> <span class="fl">1.5</span>,</span>
<span id="cb7-19"><a href="visitor-behaviour.html#cb7-19"></a>            <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb7-20"><a href="visitor-behaviour.html#cb7-20"></a>            <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb7-21"><a href="visitor-behaviour.html#cb7-21"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>frequency) <span class="op">+</span></span>
<span id="cb7-22"><a href="visitor-behaviour.html#cb7-22"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb7-23"><a href="visitor-behaviour.html#cb7-23"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>percent) <span class="op">+</span></span>
<span id="cb7-24"><a href="visitor-behaviour.html#cb7-24"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb7-25"><a href="visitor-behaviour.html#cb7-25"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;perc&quot;</span>, </span>
<span id="cb7-26"><a href="visitor-behaviour.html#cb7-26"></a>       <span class="dt">x=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb7-27"><a href="visitor-behaviour.html#cb7-27"></a>       <span class="dt">title=</span><span class="st">&quot;Visit Frequency&quot;</span>, </span>
<span id="cb7-28"><a href="visitor-behaviour.html#cb7-28"></a>       <span class="dt">caption =</span> <span class="st">&quot;Source: Visitor Insight&quot;</span>)</span>
<span id="cb7-29"><a href="visitor-behaviour.html#cb7-29"></a>g6 <span class="op">+</span></span>
<span id="cb7-30"><a href="visitor-behaviour.html#cb7-30"></a><span class="st">  </span><span class="kw">theme_gray</span>() <span class="op">+</span></span>
<span id="cb7-31"><a href="visitor-behaviour.html#cb7-31"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey50&quot;</span>))</span></code></pre></div>
<p><img src="images/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="number-of-indoor-locations-visited-per-trip" class="section level2">
<h2><span class="header-section-number">3.3</span> Number of indoor locations visited per trip</h2>
<p>The number of indoor locations visited per trip is an important measure to understnag visitor’ s journey.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="visitor-behaviour.html#cb8-1"></a>data_stores &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;C:/Users/Laurent/OneDrive - ROCS/VI/visit_stores_per_trip.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">fileEncoding=</span><span class="st">&quot;UTF-8-BOM&quot;</span>)</span>
<span id="cb8-2"><a href="visitor-behaviour.html#cb8-2"></a></span>
<span id="cb8-3"><a href="visitor-behaviour.html#cb8-3"></a>data_stores &lt;-<span class="st"> </span>data_stores <span class="op">%&gt;%</span></span>
<span id="cb8-4"><a href="visitor-behaviour.html#cb8-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date =</span> <span class="kw">as.Date</span>(date)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-5"><a href="visitor-behaviour.html#cb8-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">as.character</span>(year))</span>
<span id="cb8-6"><a href="visitor-behaviour.html#cb8-6"></a></span>
<span id="cb8-7"><a href="visitor-behaviour.html#cb8-7"></a></span>
<span id="cb8-8"><a href="visitor-behaviour.html#cb8-8"></a>data_stores_summary &lt;-<span class="st"> </span>data_stores <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-9"><a href="visitor-behaviour.html#cb8-9"></a><span class="st">  </span><span class="kw">group_by</span>(year, venues) <span class="op">%&gt;%</span></span>
<span id="cb8-10"><a href="visitor-behaviour.html#cb8-10"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">pct =</span> <span class="kw">mean</span>(pct)) </span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="visitor-behaviour.html#cb10-1"></a>g16 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data_stores_summary, <span class="kw">aes</span>(<span class="dt">x =</span> venues, <span class="dt">y =</span> pct)) <span class="op">+</span></span>
<span id="cb10-2"><a href="visitor-behaviour.html#cb10-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;royalblue4&quot;</span>)<span class="op">+</span></span>
<span id="cb10-3"><a href="visitor-behaviour.html#cb10-3"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>percent, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="op">+</span></span>
<span id="cb10-4"><a href="visitor-behaviour.html#cb10-4"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb10-5"><a href="visitor-behaviour.html#cb10-5"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>year) <span class="op">+</span></span>
<span id="cb10-6"><a href="visitor-behaviour.html#cb10-6"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> scales<span class="op">::</span><span class="kw">percent</span>((pct),<span class="fl">0.1</span>),</span>
<span id="cb10-7"><a href="visitor-behaviour.html#cb10-7"></a>                <span class="dt">y =</span> pct, </span>
<span id="cb10-8"><a href="visitor-behaviour.html#cb10-8"></a>                <span class="dt">group =</span> year,),</span>
<span id="cb10-9"><a href="visitor-behaviour.html#cb10-9"></a>            <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb10-10"><a href="visitor-behaviour.html#cb10-10"></a>            <span class="dt">vjust =</span> <span class="fl">-0.4</span>,</span>
<span id="cb10-11"><a href="visitor-behaviour.html#cb10-11"></a>            <span class="dt">colour=</span><span class="st">&quot;royalblue4&quot;</span>,</span>
<span id="cb10-12"><a href="visitor-behaviour.html#cb10-12"></a>            <span class="dt">size =</span> <span class="fl">3.5</span>) </span>
<span id="cb10-13"><a href="visitor-behaviour.html#cb10-13"></a>g16 <span class="op">+</span></span>
<span id="cb10-14"><a href="visitor-behaviour.html#cb10-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;perc.(%)&quot;</span>, </span>
<span id="cb10-15"><a href="visitor-behaviour.html#cb10-15"></a>       <span class="dt">x=</span><span class="st">&quot;venues&quot;</span>,</span>
<span id="cb10-16"><a href="visitor-behaviour.html#cb10-16"></a>       <span class="dt">title=</span><span class="st">&quot;Number of indoor locations visited per trip&quot;</span>,</span>
<span id="cb10-17"><a href="visitor-behaviour.html#cb10-17"></a>       <span class="dt">caption =</span> <span class="st">&quot;Source: Visitor Insights&quot;</span>)</span></code></pre></div>
<p><img src="images/unnamed-chunk-9-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visit-frequency.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visitor-profile.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
